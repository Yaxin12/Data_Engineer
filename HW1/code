cd E:\DataEnigneer\2_docker_sql
pgcli -h localhost -p 5432 -u root -d ny_taxi

docker run -it \
  -e POSTGRES_USER="root" \
  -e POSTGRES_PASSWORD="root" \
  -e POSTGRES_DB="ny_taxi" \
  -v e:/DataEnigneer/2_docker_sql/ny_taxi_postgres_data/ny_taxi_postgres_data:/var/lib/postgresql/data \
  -p 5432:5432 \
  --network=pg-network \
  --name pg-database \
  postgres:13

jupyter notebook

docker run -it \
  -e PGADMIN_DEFAULT_EMAIL="admin@admin.com" \
  -e PGADMIN_DEFAULT_PASSWORD="root" \
  -p 8080:80 \
  --network=pg-network \
  --name pgadmin-2 \
  dpage/pgadmin4 

PGADMIN

SELECT COUNT(*)
FROM green_taxi_data
WHERE trip_distance <= 1
AND lpep_dropoff_datetime BETWEEN '2019-10-01' AND '2019-11-01';

SELECT COUNT(*)
FROM green_taxi_data
WHERE trip_distance <= 3 AND trip_distance > 1 
AND lpep_dropoff_datetime BETWEEN '2019-10-01' AND '2019-11-01';

SELECT COUNT(*)
FROM green_taxi_data
WHERE trip_distance <= 3 AND trip_distance > 7 
AND lpep_dropoff_datetime BETWEEN '2019-10-01' AND '2019-11-01';

SELECT COUNT(*)
FROM green_taxi_data
WHERE trip_distance <= 10 AND trip_distance > 7 
AND lpep_dropoff_datetime BETWEEN '2019-10-01' AND '2019-11-01';

SELECT COUNT(*)
FROM green_taxi_data
WHERE trip_distance > 10 
AND lpep_dropoff_datetime BETWEEN '2019-10-01' AND '2019-11-01';

SELECT 
    DATE(lpep_dropoff_datetime) AS pickup_date,
    SUM(trip_distance) AS total_distance
FROM 
    green_taxi_data
GROUP BY 
    DATE(lpep_dropoff_datetime)
ORDER BY 
    total_distance DESC
LIMIT 1

SELECT zs.Zone, yt."PULocationID" AS pickupID, SUM(yt.total_amount) AS total_amount_sum
FROM green_taxi_data yt
JOIN zones zs ON yt."PULocationID" = zs."LocationID"
WHERE yt.tpep_pickup_datetime BETWEEN '2019-10-18' AND '2019-10-19'
GROUP BY zs.Zone, yt."PULocationID"
HAVING SUM(yt.total_amount) > 13000
ORDER BY total_amount_sum DESC;

SELECT zs2.Zone AS dropoff_zone, MAX(yt.tip_amount) AS max_tip
FROM green_taxi_data yt
JOIN zones zs1 ON yt."PULocationID" = zs1."LocationID"
JOIN zones zs2 ON yt."DOLocationID" = zs2."LocationID"
WHERE zs1.Zone = 'East Harlem North'
  AND yt.tpep_pickup_datetime BETWEEN '2019-10-01' AND '2019-10-31'
GROUP BY zs2.Zone
ORDER BY max_tip DESC
LIMIT 1;
